# 猫背検知アプリ (Nekoze Detector)

Web カメラを使用してリアルタイムで姿勢を推定し、猫背（Bad Posture）かどうかを判定する Python アプリケーションです。
Google の MediaPipe Pose ライブラリを使用して身体のランドマーク（耳、肩など）を検出し、その位置関係から姿勢を評価します。

## 機能

- **リアルタイム姿勢推定**: Web カメラの映像から瞬時に骨格を検出します。
- **猫背判定**: 耳と肩の位置関係および肩幅の比率を計算し、閾値を下回ると「Bad Posture（猫背）」と判定して警告表示します。
- **視覚的フィードバック**:
  - 良い姿勢: 緑色で "Good Posture"
  - 悪い姿勢: 赤色で "Bad Posture"
  - 現在の判定スコア（Ratio）を画面上に表示

## 必要要件

以下のライブラリが必要です。

- Python 3.x
- opencv-python
- mediapipe
- numpy

## インストール

必要なライブラリを pip コマンドでインストールしてください。

```bash
pip install opencv-python mediapipe numpy
```

## 使い方

1. アプリケーションを実行します。

```bash
python main.py
```

2. Web カメラが起動します。カメラに向かって正面に座ってください。

   - 上半身（特に肩と頭）がカメラに映るようにしてください。

3. 画面左上に現在の判定結果が表示されます。

   - **Good Posture**: 姿勢が良い状態
   - **Bad Posture**: 猫背の状態

4. 終了するには、キーボードの `q` キーを押してください。

## 判定ロジックについて

このプログラムでは、以下の計算式を用いて猫背を判定しています。

$$
Ratio = \frac{\text{耳と肩の垂直距離}}{\text{肩幅}}
$$

- **耳と肩の垂直距離**: 猫背になり顔が前に出たり下がったりすると、この距離が短くなります。
- **肩幅**: カメラとの距離による誤差を減らすための正規化基準として使用しています。

算出された `Ratio` が `THRESHOLD_RATIO`（デフォルト: 0.7）を下回ると、猫背と判定されます。

## 設定の調整

[main.py](main.py) 内の以下の変数を変更することで、環境に合わせた調整が可能です。

### カメラの変更

PC 内蔵カメラを使用する場合など、カメラが開かないときは `cv2.VideoCapture` の引数を変更してください。

````python
# 32行目付近
cap = cv2.VideoCapture(0) # 0: 内蔵カメラ, 1: 外部// filepath: README.md
# 猫背検知アプリ (Nekoze Detector)

Webカメラを使用してリアルタイムで姿勢を推定し、猫背（Bad Posture）かどうかを判定するPythonアプリケーションです。
GoogleのMediaPipe Poseライブラリを使用して身体のランドマーク（耳、肩など）を検出し、その位置関係から姿勢を評価します。

## 機能

- **リアルタイム姿勢推定**: Webカメラの映像から瞬時に骨格を検出します。
- **猫背判定**: 耳と肩の位置関係および肩幅の比率を計算し、閾値を下回ると「Bad Posture（猫背）」と判定して警告表示します。
- **視覚的フィードバック**:
  - 良い姿勢: 緑色で "Good Posture"
  - 悪い姿勢: 赤色で "Bad Posture"
  - 現在の判定スコア（Ratio）を画面上に表示

## 必要要件

以下のライブラリが必要です。

- Python 3.x
- opencv-python
- mediapipe
- numpy

## インストール

必要なライブラリをpipコマンドでインストールしてください。

```bash
pip install opencv-python mediapipe numpy
````

## 使い方

1. アプリケーションを実行します。

```bash
python main.py
```

2. Web カメラが起動します。カメラに向かって正面に座ってください。

   - 上半身（特に肩と頭）がカメラに映るようにしてください。

3. 画面左上に現在の判定結果が表示されます。

   - **Good Posture**: 姿勢が良い状態
   - **Bad Posture**: 猫背の状態

4. 終了するには、キーボードの `q` キーを押してください。

## 判定ロジックについて

このプログラムでは、以下の計算式を用いて猫背を判定しています。

$$
Ratio = \frac{\text{耳と肩の垂直距離}}{\text{肩幅}}
$$

- **耳と肩の垂直距離**: 猫背になり顔が前に出たり下がったりすると、この距離が短くなります。
- **肩幅**: カメラとの距離による誤差を減らすための正規化基準として使用しています。

算出された `Ratio` が `THRESHOLD_RATIO`（デフォルト: 0.7）を下回ると、猫背と判定されます。

## 設定の調整

[main.py](main.py) 内の以下の変数を変更することで、環境に合わせた調整が可能です。

### カメラの変更

PC 内蔵カメラを使用する場合など、カメラが開かないときは `cv2.VideoCapture` の引数を変更してください。

```python
# 32行目付近
cap = cv2.VideoCapture(0) # 0: 内蔵カメラ, 1: 外部
```
